<!DOCTYPE html>
<html>
<head>
  <title>DAVE-CO INDUSTRIES - ADMIN</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=VT323&display=swap');
    
    :root {
      --term-color: #8b55d6; 
      --term-glow: rgba(139, 85, 214, 0.5);
      --term-bg: #000;
      --system-ok: #00ff41;
    }

    body { background-color: var(--term-bg); color: var(--term-color); font-family: 'VT323', monospace; margin: 0; padding: 20px; height: 100vh; overflow-y: auto; text-transform: uppercase; }
    body::before { content: " "; display: block; position: fixed; top: 0; left: 0; bottom: 0; right: 0; background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06)); z-index: 2; background-size: 100% 2px, 3px 100%; pointer-events: none; }
    
    h1 { border-bottom: 2px solid var(--term-color); padding-bottom: 10px; text-shadow: 0 0 10px var(--term-color); font-size: 2.5rem; margin-top: 0; }
    .panel-box { border: 2px solid var(--term-color); padding: 15px; margin-bottom: 20px; box-shadow: 0 0 15px var(--term-glow); background: rgba(20, 10, 30, 0.8); position: relative; z-index: 10;}
    h2 { margin-top: 0; font-size: 1.5rem; text-shadow: 0 0 5px var(--term-color); }
    
    /* HEARTBEAT CSS */
    .status-panel { display: flex; align-items: center; gap: 15px; margin-bottom: 20px; color: var(--system-ok); font-size: 1.2rem; }
    .heartbeat { width: 12px; height: 12px; border-radius: 50%; background: var(--system-ok); box-shadow: 0 0 10px var(--system-ok); animation: pulse 1.5s infinite; }
    @keyframes pulse { 0% { opacity: 1; transform: scale(1); } 50% { opacity: 0.3; transform: scale(0.8); } 100% { opacity: 1; transform: scale(1); } }

    label { display: block; font-size: 1.5rem; margin-bottom: 10px; }
    input[type=range] { width: 100%; accent-color: var(--term-color); height: 20px; background: #111; border: 1px solid var(--term-color); }
    input[type=number], select { background: #000; color: var(--term-color); border: 2px solid var(--term-color); font-family: 'VT323', monospace; font-size: 1.5rem; padding: 5px; width: 100%; text-align: center; margin-bottom: 10px; outline: none; }
    
    .value-readout { float: right; }
    .btn-group { display: flex; gap: 10px; margin-top: 10px; }
    
    button { background: #000; color: var(--term-color); border: 2px solid var(--term-color); font-family: 'VT323', monospace; font-size: 1.5rem; padding: 10px 20px; cursor: pointer; flex: 1; transition: 0.2s; text-transform: uppercase; }
    button:hover { background: var(--term-color); color: #000; box-shadow: 0 0 15px var(--term-color); }
    
    .btn-fireworks { background: var(--term-color); color: #000; font-weight: bold; font-size: 1.8rem; }
    .btn-unlock { background: #80a2df; color: #000; border-color: #80a2df; }
    .btn-danger { border-color: #ff3333; color: #ff3333; }
    .btn-danger:hover { background: #ff3333; color: #000; }
    
    .input-row { display: flex; justify-content: space-between; align-items: center; gap: 10px; margin-bottom: 10px; }
  </style>
</head>
<body>

  <h1>DAVE-CO INDUSTRIES <br> COMMAND CENTER</h1>

  <div class="panel-box">
    <div class="status-panel">
      <div class="heartbeat"></div>
      <span>SYSTEM ONLINE // FIREBASE LINK STABLE // PING: <span id="ping-ms">--</span>ms</span>
    </div>
  </div>

  <div class="panel-box">
    <h2>> SPECIAL EVENT FX</h2>
    <button class="btn-fireworks" onclick="launchFireworks()">LAUNCH FIREWORKS</button>
  </div>

  <div class="panel-box">
    <h2>> CROWD CONTROL</h2>
    <button class="btn-unlock" onclick="unlockVoting()">UNLOCK AUDIENCE PHONES</button>
  </div>

  <div class="panel-box">
    <h2>> MANUAL SCORE OVERRIDE</h2>
    <div class="input-row">
      <label>LEFT SIDE:</label>
      <input type="number" id="manualLeft" placeholder="0">
      <button onclick="setScore('left')">SET</button>
    </div>
    <div class="input-row">
      <label>RIGHT SIDE:</label>
      <input type="number" id="manualRight" placeholder="0">
      <button onclick="setScore('right')">SET</button>
    </div>
  </div>

  <div class="panel-box">
    <h2>> QUICK ADJUST (+/-)</h2>
    <div style="display:flex; justify-content:space-between; margin-bottom:10px; font-size: 1.8rem;">
      <span>L-SIDE: <strong id="scoreL">0</strong></span>
      <span>R-SIDE: <strong id="scoreR">0</strong></span>
    </div>
    <div class="btn-group">
      <button onclick="mod('left', -1)">L -1</button>
      <button onclick="mod('left', 1)">L +1</button>
      <button onclick="mod('right', -1)">R -1</button>
      <button onclick="mod('right', 1)">R +1</button>
    </div>
  </div>

  <div class="panel-box">
    <h2>> VISUAL REFERENCES</h2>
    <div class="input-row">
      <div style="flex:1; padding-right:10px;">
        <label>LEFT DISH:</label>
        <select id="sel_iconLeft" onchange="updateConfig()">
          <option value="none">None</option>
          <option value="brick">Brick</option>
          <option value="house">Small House</option>
          <option value="hardhat">Hard Hat</option>
          <option value="clipboard">Clipboard</option>
          <option value="crane">Crane</option>
        </select>
      </div>
      <div style="flex:1;">
        <label>RIGHT DISH:</label>
        <select id="sel_iconRight" onchange="updateConfig()">
          <option value="none">None</option>
          <option value="brick">Brick</option>
          <option value="house">Small House</option>
          <option value="hardhat">Hard Hat</option>
          <option value="clipboard">Clipboard</option>
          <option value="crane">Crane</option>
        </select>
      </div>
    </div>
  </div>

  <div class="panel-box danger-zone">
    <h2>> DANGER ZONE</h2>
    <button class="btn-danger" onclick="nukeIt()">INITIATE RESET PROTOCOL</button>
  </div>

  <script type="module">
    import { db, scaleRef, update, set, increment, onValue } from './firebase-config.js';

    let lastActive = Date.now();

    onValue(scaleRef, (snapshot) => {
      // PING CALC
      const now = Date.now();
      document.getElementById('ping-ms').innerText = now - lastActive > 2000 ? '20' : now - lastActive;
      lastActive = now;

      const data = snapshot.val() || {};
      const config = data.config || {};

      document.getElementById('sel_iconLeft').value = config.iconLeft || 'none';
      document.getElementById('sel_iconRight').value = config.iconRight || 'none';
      document.getElementById('scoreL').innerText = data.left || 0;
      document.getElementById('scoreR').innerText = data.right || 0;
    });

    window.updateConfig = function() {
      update(scaleRef, {
        "config/iconLeft": document.getElementById('sel_iconLeft').value,
        "config/iconRight": document.getElementById('sel_iconRight').value
      });
    }

    window.setScore = function(side) {
      const val = parseInt(document.getElementById(side === 'left' ? 'manualLeft' : 'manualRight').value);
      if (!isNaN(val)) {
        const updates = {}; updates[side] = val; update(scaleRef, updates);
      }
    }

    window.mod = function(side, val) {
      const updates = {}; updates[side] = increment(val); update(scaleRef, updates);
    }

    window.launchFireworks = function() { update(scaleRef, { "config/fireworks": Date.now() }); }
    
    window.unlockVoting = function() { update(scaleRef, { "config/votingRound": Date.now() }); }

    window.nukeIt = function() {
      if(confirm("CONFIRM SYSTEM WIPE?")) {
        set(scaleRef, { 
          left: 0, right: 0,
          config: { sensitivity: 5, maxTilt: 25, iconLeft: 'none', iconRight: 'none', fireworks: 0, votingRound: Date.now() }
        });
      }
    }
  </script>
</body>
</html>
